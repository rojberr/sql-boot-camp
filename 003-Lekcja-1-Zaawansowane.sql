-- Exercise 1
SELECT NAZWISKO, SUBSTR(ETAT, 1, 2) || ID_PRAC AS KOD
FROM PRACOWNICY;

/*
NAZWISKO KOD
--------------- ------
WEGLARZ DY100
BLAZEWICZ PR110
SLOWINSKI PR120
BRZEZINSKI PR130
MORZY PR140
KROLIKOWSKI AD150
KOSZLAJDA AD160
JEZIERSKI AS170
MATYSIAK AS190
MAREK SE180
ZAKRZEWICZ ST200
BIALY ST210
KONOPKA AS220
HAPKE AS230
*/

-- Exercise 2
SELECT NAZWISKO,
       REPLACE(
               REPLACE(
                       REPLACE(NAZWISKO, 'K', 'X'),
                       'L', 'X'),
               'M', 'X')
           AS WOJNA_LITEROM
FROM PRACOWNICY;

/*
NAZWISKO WOJNA_LITEROM
--------------- ---------------
WEGLARZ WEGXARZ
BLAZEWICZ BXAZEWICZ
SLOWINSKI SXOWINSXI
BRZEZINSKI BRZEZINSXI
MORZY XORZY
KROLIKOWSKI XROXIXOWSXI
KOSZLAJDA XOSZXAJDA
JEZIERSKI JEZIERSXI
MATYSIAK XATYSIAX
MAREK XAREX
ZAKRZEWICZ ZAXRZEWICZ
BIALY BIAXY
KONOPKA XONOPXA
HAPKE HAPXE
*/

-- Exercise 3
SELECT NAZWISKO FROM PRACOWNICY WHERE SUBSTR(NAZWISKO,1,LENGTH(NAZWISKO)/2)
                                          LIKE '%L%';

/*
NAZWISKO
---------------
BLAZEWICZ
SLOWINSKI
KROLIKOWSKI
*/

-- Exercise 4
SELECT NAZWISKO, ROUND(PLACA_POD * 1.15) AS PODWYZKA FROM PRACOWNICY;

/*
NAZWISKO PODWYZKA
--------------- ---------
WEGLARZ 1990
BLAZEWICZ 1553
SLOWINSKI 1231
BRZEZINSKI 1104
MORZY 955
KROLIKOWSKI 742
KOSZLAJDA 679
JEZIERSKI 506
MATYSIAK 427
MAREK 472
ZAKRZEWICZ 239
BIALY 288
KONOPKA 552
HAPKE 552
*/

-- Exercise 5
SELECT NAZWISKO, PLACA_POD,
       PLACA_POD * 0.2 AS INWESTYCJA,
       PLACA_POD * 0.2 * POWER(1.1, 10) AS KAPITAL,
       PLACA_POD * 0.2 * POWER(1.1, 10) - PLACA_POD * 0.2 AS ZYSK
FROM PRACOWNICY;

/*
NAZWISKO PLACA_POD INWESTYCJA KAPITAL ZYSK
--------------- ---------- ---------- ---------- ----------
WEGLARZ 1730 346 897,434 551,434
BLAZEWICZ 1350 270 700,310 430,310
SLOWINSKI 1070 214 555,060 341,060
BRZEZINSKI 960 192 497,998 305,998
MORZY 830 166 430,561 264,561
KROLIKOWSKI 645,5 129,1 334,852 205,752
KOSZLAJDA 590 118 306,061 188,061
JEZIERSKI 439,7 87,94 228,093 140,153
MATYSIAK 371 74,2 192,455 118,255
MAREK 410,2 82,04 212,790 130,750
ZAKRZEWICZ 208 41,6 107,899 66,2996
BIALY 250 50 129,687 79,687
KONOPKA 480 96 248,999 152,999
HAPKE 480 96 248,999 152,999
*/

-- Exercise 6
SELECT NAZWISKO, ZATRUDNIONY,
       FLOOR((DATE'2000-01-01' - ZATRUDNIONY) / 365.245) AS STAZ_W_2000
FROM PRACOWNICY;

/*
NAZWISKO ZATRUDNI STAZ_W_2000
--------------- -------- -----------
WEGLARZ 68/01/01 32
BLAZEWICZ 73/05/01 26
SLOWINSKI 77/09/01 22
BRZEZINSKI 68/07/01 31
MORZY 75/09/15 24
KROLIKOWSKI 77/09/01 22
KOSZLAJDA 85/03/01 14
JEZIERSKI 92/10/01 7
MATYSIAK 93/09/01 6
MAREK 85/02/20 14
ZAKRZEWICZ 94/07/15 5
BIALY 93/10/15 6
KONOPKA 93/10/01 6
HAPKE 92/09/01 7
*/

-- Exercise 7
SELECT NAZWISKO,
       TO_CHAR(ZATRUDNIONY,'MONTH , DD YYYY') AS DATA_ZATRUDNIENIA
FROM PRACOWNICY
WHERE ID_ZESP = 20;


/*
NAZWISKO DATA_ZATRUDNIENIA
--------------- --------------------
BRZEZINSKI LIPIEC , 01 1968
MORZY WRZESIEÅƒ , 15 1975
KROLIKOWSKI WRZESIEÅƒ , 01 1977
KOSZLAJDA MARZEC , 01 1985
JEZIERSKI PAÅ¹DZIERNIK, 01 1992
MATYSIAK WRZESIEÅƒ , 01 1993
KONOPKA PAÅ¹DZIERNIK, 01 1993
*/

-- Exercise 8
SELECT TO_CHAR(SYSDATE,'DAY') AS DZIS FROM DUAL;

/*
DZIS
------------
SOBOTA
*/

-- Exercise 9
SELECT NAZWA,
       ADRES,
       CASE
           WHEN ADRES LIKE '%MIELZYNSKIEGO%' THEN 'STARE MIASTO'
           WHEN ADRES LIKE '%STRZELECKA%' THEN 'STARE MIASTO'
           WHEN ADRES LIKE '%PIOTROWO%' THEN 'NOWE MIASTO'
           WHEN ADRES LIKE '%WLODKOWICA%' THEN 'GRUNWALD'
           END AS DZIELNICA
FROM ZESPOLY;

/*
NAZWA ADRES DZIELNICA
-------------------- -------------------- ------------
ADMINISTRACJA PIOTROWO 3A NOWE MIASTO
SYSTEMY ROZPROSZONE PIOTROWO 3A NOWE MIASTO
SYSTEMY EKSPERCKIE STRZELECKA 14 STARE MIASTO
ALGORYTMY WLODKOWICA 16 GRUNWALD
BADANIA OPERACYJNE MIELZYNSKIEGO 30 STARE MIASTO
*/

-- Exercise 10
SELECT NAZWISKO,
       PLACA_POD,
       CASE
           WHEN PLACA_POD > 480 THEN 'Powyzej 480'
           WHEN PLACA_POD = 480 THEN 'Dokladnie 480'
           WHEN PLACA_POD < 480 THEN 'Ponizej 480'
           END AS PROG
FROM PRACOWNICY ORDER BY PLACA_POD DESC;

/*
NAZWISKO PLACA_POD PRÃ“G
--------------- ---------- -------------
WEGLARZ 1730 PowyÅ¼ej 480
BLAZEWICZ 1350 PowyÅ¼ej 480
SLOWINSKI 1070 PowyÅ¼ej 480
BRZEZINSKI 960 PowyÅ¼ej 480
MORZY 830 PowyÅ¼ej 480
KROLIKOWSKI 645,5 PowyÅ¼ej 480
KOSZLAJDA 590 PowyÅ¼ej 480
KONOPKA 480 DokÅ‚adnie 480
HAPKE 480 DokÅ‚adnie 480
JEZIERSKI 439,7 PoniÅ¼ej 480
MAREK 410,2 PoniÅ¼ej 480
MATYSIAK 371 PoniÅ¼ej 480
BIALY 250 PoniÅ¼ej 480
ZAKRZEWICZ 208 PoniÅ¼ej 480
*/

-- Exercise for volunteers -- implement exercise 9 using DECODE
SELECT NAZWISKO,
       PLACA_POD,
       DECODE(PLACA_POD,
              PLACA_POD > 480, 'Powyzej 480',
              PLACA_POD < 480, 'Ponizej 480',
              'DOkladnie 480')
           AS PROG
FROM PRACOWNICY ORDER BY PLACA_POD DESC;

/*
NAZWISKO PLACA_POD PRÃ“G
--------------- ---------- -------------
WEGLARZ 1730 PowyÅ¼ej 480
BLAZEWICZ 1350 PowyÅ¼ej 480
SLOWINSKI 1070 PowyÅ¼ej 480
BRZEZINSKI 960 PowyÅ¼ej 480
MORZY 830 PowyÅ¼ej 480
KROLIKOWSKI 645,5 PowyÅ¼ej 480
KOSZLAJDA 590 PowyÅ¼ej 480
KONOPKA 480 DokÅ‚adnie 480
HAPKE 480 DokÅ‚adnie 480
JEZIERSKI 439,7 PoniÅ¼ej 480
MAREK 410,2 PoniÅ¼ej 480
MATYSIAK 371 PoniÅ¼ej 480
BIALY 250 PoniÅ¼ej 480
ZAKRZEWICZ 208 PoniÅ¼ej 480
*/
